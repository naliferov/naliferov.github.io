const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vue.runtime.esm-bundler-xPg14T-6.js","assets/runtime-dom.esm-bundler-CSgN8uhz.js","assets/main-CWdu7P4D.js","assets/main-Dex0ysYf.css"])))=>i.map(i=>d[i]);
import{_ as i}from"./index-7vvO_ANn.js";const c=await i(()=>import("./vue.runtime.esm-bundler-xPg14T-6.js"),__vite__mapDeps([0,1])),e={};globalThis.x=e;{const[{Redis:t},{ulid:s}]=await Promise.all([i(()=>import("https://esm.sh/@upstash/redis"),[]),i(()=>import("https://esm.sh/ulid?bundle"),[])]);e.redis=new t({url:"https://holy-redfish-7937.upstash.io",token:localStorage.getItem("token")||"Ah8BAAIgcDH8iJl1rQK-FZD7U3lrmcixchbsva9z2HQRDxtGlxLOrA"}),e.ulid=s}{const t=document.createElement("link");t.rel="stylesheet",t.href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap",document.head.append(t)}{const{promise:t,resolve:s}=Promise.withResolvers(),o=document.createElement("script");o.src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js",o.onload=()=>{require.config({paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}}),require(["vs/editor/editor.main"],s)},document.head.append(o),await t}{class t{get(o){return localStorage.getItem(o)}set(o,a){localStorage.setItem(o,a)}del(o){localStorage.removeItem(o)}on(o){this.set(o,"1")}off(o){this.del(o)}}e.kvRepo=new t}e.track=c.ref("sys");e.sys=c.ref({});e.user=c.ref({});e.openedObjects=c.ref([]);e.showSideBar=c.ref(!0);e.showFileInput=c.ref(!1);e.set=async(t,s)=>await e.redis.hset(e.track.value,{[t]:s});e.get=async t=>await e.redis.redis.hget(e.track.value,t);e.del=async t=>await e.redis.redis.hdel(e.track.value,t);{const t=Object.values(await e.redis.hgetall(e.track.value));t.sort((s,o)=>(s.name>o.name)-(s.name<o.name)),e.sys.value=Object.fromEntries(t.map(s=>[s.id,s]))}{const t=await e.kvRepo.get("openedObjects")??[];e.openedObjects.value=typeof t=="string"?JSON.parse(t):t,e.openedObjects.value=e.openedObjects.value.filter(s=>s.objectId&&e.sys.value[s.objectId]),c.watch(e.openedObjects,s=>{const o=s.map(a=>c.toRaw(a));e.kvRepo.set("openedObjects",JSON.stringify(o))},{deep:!0})}{const t="showSideBar";c.watch(e.showSideBar,s=>s?e.kvRepo.on(t):e.kvRepo.off(t))}{const t="showFileInput";e.kvRepo.get(t)&&(e[t].value=!0),c.watch(e[t],s=>s?e.kvRepo.on(t):e.kvRepo.off(t))}e.getById=t=>e.sys.value[t];e.getByName=(t,s="sys")=>{const a=(s==="sys"?e.sys:e.user).value;for(const n in a){const r=a[n];if(r.name===t)return r}};e.runById=async(t,s={})=>{const o=e.getById(t);if(o&&o.code)return await e.runCode(o.code,s,o.name)};e.runByName=async(t,s={})=>{const o=e.getByName(t);if(o&&o.code)return await e.runCode(o.code,s,o.name)};e.getOpenedObject=t=>{for(const s of e.openedObjects.value)if(s.id===t)return s};e.updateObject=t=>{const o=(t.repoName==="sys"?e.sys:e.user).value[t.objectId];if(!o)return;const a=c.toRaw(o);t.code&&(a.code=t.code),t.data&&(a.data=t.data),(t.code||t.data)&&e.set(a.id,a);const n=e.getOpenedObject(t.openedObjectId);n&&(t.position&&(n.position=t.position),t.frameParams&&(n.frameParams=t.frameParams))};e.createCMDs=(t={})=>{const s={add:{f:async o=>{const[a]=o;if(e.getByName(a)){console.log(`object with name ${a} already exists`);return}const r={id:e.ulid(),name:a.trim()};o.bin&&(r.bin=o.bin),e.sys.value[r.id]=r,await e.set(r.id,r)},desc:"Function for adding new objects in list of functions. Example: add {new objectName}"},del:{f:async([o])=>{const a=e.getByName(o);if(a){delete e.sys.value[a.id],await e.del(a.id);return}console.log(`object with name ${o} not found`)},desc:"Function for deleting objects from the list by name. Example: del {objectName}"},delById:{f:async([o])=>await e.del(o),desc:"Function for delete object by id. Example: mv oldName newName"},mv:{f:async([o,a])=>{const n=e.getByName(o);n&&(n.name=a,await e.set(n.id,n))},desc:"Function for rename object. Example: mv oldName newName"},setProp:{f:async([o,a,n])=>{const r=e.getByName(o);!r||!a||!n||(r[a.trim()]=n.trim(),await e.set(r.id,r))},desc:"Find object by name, set prop and value. Example"},delProp:{f:async([o,a])=>{const n=e.getByName(o);n&&(delete n[a],await e.set(n.id,n))},desc:"Find object by name, del prop. Example"},open:{f([o,a]){const n=e.getByName(o);!n||!a||e.openedObjects.value.push({repoName:"sys",id:e.ulid(),objectId:n.id,opener:a})},desc:"Function for open objects as app. Example: run objectName arg1 arg2 ..."},log:{f:async([o])=>{const a=e.getByName(o);a&&console.log(c.toRaw(a))},desc:"Function for logging object by name. Example: run functionName arg1 arg2 ..."},fileInput:{f:async()=>{e.showFileInput.value=!e.showFileInput.value},desc:"Function for logging object by name. Example: run functionName arg1 arg2 ..."},exportDump:{f:async([])=>{const o=document.createElement("a");o.href=URL.createObjectURL(new Blob([JSON.stringify(e.sys.value)],{type:"application/json"})),o.download="dump.json",o.click(),URL.revokeObjectURL(o.href)},desc:"Export dump"}};return Object.assign(s,t),s};e.sysCMDs=e.createCMDs({repoName:"sys"});e.userCMDs=e.createCMDs({repoName:"user",async"import-dump"(){}});e.readFileAsBase64=async t=>{const{promise:s,resolve:o,reject:a}=Promise.withResolvers(),n=new FileReader;return n.readAsDataURL(t),n.onload=()=>{const r=n.result.split(",")[1];o(r)},n.onerror=a,s};{const{createApp:t}=c,{default:s}=await i(async()=>{const{default:o}=await import("./main-CWdu7P4D.js");return{default:o}},__vite__mapDeps([2,1,3]));e.app=t(s)}export{e as default};
